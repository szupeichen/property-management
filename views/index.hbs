<div class="h-100 container fluid">
  {{!-- 新增/刪除按鈕 --}}
  <div class="row my-3">
    <div class="col-auto">
      <a href="/units/new" class="btn btn-warning">新增房產單位</a>
    </div>
    {{#if user.isAdmin }}
    <div class="col-auto">
      <form action="/units/delete" method="GET" style="display: inline;">
        <button class="btn btn-danger" type="submit">刪除房產單位</button>
      </form>
    </div>
    {{/if}}
  </div>
  {{!-- 篩選按鈕 --}}
  <div class="row mb-3">
    <div class="col">
      <input type="text" class="form-control" placeholder="輸入關鍵字" aria-label="searchBar"
        aria-describedby="basic-addon1">
    </div>
    <div class="col">
      <select class="form-select bg-light.bg-gradient" id="counterFilter" name="counterFilter" aria-label="filter">
        <option selected>依縣市篩選</option>
        {{#each Units}}
        <option value="{{this.city.id}}"></option>
        {{/each}}
      </select>
    </div>
    <div class="col">
      <select class="form-select bg-light.bg-gradient" id="agencyFilter" name="agencyFilter" aria-label="agencyFilter">
        <option selected>依房仲篩選</option>
        {{#each Agencies}}
        <option value="{{this.id}}">{{this.name}}</option>
        {{/each}}
      </select>
    </div>
    <div class="col">
      <select class="form-select bg-light.bg-gradient" aria-label="dateFilter">
        <option selected>日期排序</option>
        <option value="">日期近至遠</option>
        <option value="1">日期遠至近</option>
      </select>
    </div>
    <div class="col-2">
      <form action="/" method="get">
        <button type="button" class="btn btn-secondary">搜索</button>
      </form>
    </div>


  </div>
  {{!-- 資料顯示區 --}}
  <div class="row">
    <div class="col">
      <table class="table text-end">
        <thead class="table-dark">
          <tr class="table-secondary">
            <th scope="col" class="text-center">縣市</th>
            <th scope="col" class="text-center">地址</th>
            <th scope="col">
              <p class="m-0">租約訖日</p>
              <p class="m-0">(YYYY-MM-DD)</p>
            </th>
            <th scope="col">月租金</th>
            <th scope="col">年租金</th>
            <th scope="col">服務仲介</th>
            <th scope="col" class="text-center">狀態</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          {{!-- {{> table-template}} --}}

          {{#each units}}
          <tr>
            <td scope="col" class="text-center">{{ this.city }}</td>
            <td scope="col" class="text-center">{{ this.address }}</td>
            <td scope="col">{{#if this.endDate }}{{formatDate this.endDate}}{{else}}{{/if}}</td>
            <td scope="col">{{ this.income }}</td>
            <td scope="col">{{ this.annualIncome }}</td>
            <td scope="col">{{ this.Agency.name }}</td>
            <td scope="col" class="text-center">{{#if this.status }}已出租{{else}}未出租{{/if}}</td>
            <td scope="col" class="text-center d-flex flex-grow-1">
              <div class="w-50 me-2 "><a class="btn btn-outline-warning w-100 flex-grow-1" href="./units/{{ this.id }}">detail</a>
              </div>
              <div class="w-50"><a class="btn btn-outline-warning w-100" href="./units/{{ this.id }}/edit">edit</a>
              </div>
            </td>
          </tr>
          {{/each}}

        </tbody>
      </table>
    </div>
  </div>

  {{!-- pagination setting--}}
  <div class="row">
    <nav aria-label="Page navigation">
      <ul class="pagination d-flex justify-content-center">
        <li class="page-item {{#ifCond pagination.currentPage 1}}disabled{{/ifCond}}">
          <a class="page-link" href="/?page={{pagination.prev}}" aria-label="Previous">
            <span aria-hidden="true">&laquo;</span>
          </a>
        </li>
        {{#each pagination.pages}}
        {{#ifCond this ../pagination.currentPage}}
        <li class="page-item active"><a class="page-link" href="/?page={{this}}">{{this}}</a></li>
        {{else}}
        <li class="page-item">
          <a class="page-link" href="/?page={{this}}">{{this}}</a>
        </li>
        {{/ifCond}}
        {{/each}}
        <li class="page-item {{#ifCond pagination.currentPage pagination.totalPage}}disabled{{/ifCond}}">
          <a class="page-link" href="/?page={{pagination.next}}" aria-label="Next">
            <span aria-hidden="true">&raquo;</span>
          </a>
        </li>
      </ul>
    </nav>
  </div>

</div>

{{!-- table-template script --}}
<script src="../views/partials/table-template.hbs"></script>
{{!-- jQuery --}}
{{> jQuery-script}}